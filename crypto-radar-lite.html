<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>RENVOX Crypto Radar â€” Binance v3</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
  body{background:#0b0e12;color:#e2e8f0;font-family:Inter,Arial,sans-serif}
  .chip{padding:.3rem .6rem;border-radius:9999px;font-weight:600}
</style>
</head>
<body class="p-6">
<h1 class="text-3xl font-bold text-green-400 mb-2 text-center">RENVOX Crypto Radar â€” Binance v3</h1>
<p class="text-gray-400 text-center mb-6">
Datos directos desde Binance API (velas de 1h).<br>
RSI14 Â· EMA20/50 Â· Fibonacci (14d). Refresca cada 1 hora automÃ¡ticamente.
</p>

<div class="overflow-x-auto border border-gray-700 rounded-xl">
<table class="w-full text-sm text-center" id="table">
  <thead class="bg-gray-800 text-gray-300">
    <tr>
      <th class="py-2">Token</th>
      <th class="py-2">Precio</th>
      <th class="py-2">RSI14</th>
      <th class="py-2">EMA20/50</th>
      <th class="py-2">Zona Fibo</th>
      <th class="py-2">SeÃ±al</th>
    </tr>
  </thead>
  <tbody id="rows" class="bg-gray-900"></tbody>
</table>
</div>

<script>
const pairs=["BTCUSDT","ETHUSDT","SOLUSDT"];
let idx=0;

function ema(values,span){
  const k=2/(span+1);let emaArr=[values[0]];let prev=values[0];
  for(let i=1;i<values.length;i++){prev=values[i]*k+prev*(1-k);emaArr.push(prev);}
  return emaArr;
}
function rsi(values,period=14){
  let gains=0,losses=0;
  for(let i=1;i<=period;i++){const d=values[i]-values[i-1];if(d>=0)gains+=d;else losses-=d;}
  let avgG=gains/period,avgL=losses/period;
  for(let i=period+1;i<values.length;i++){
    const d=values[i]-values[i-1];const g=Math.max(d,0),l=Math.max(-d,0);
    avgG=(avgG*(period-1)+g)/period;avgL=(avgL*(period-1)+l)/period;
  }
  const rs=avgL===0?100:avgG/avgL;
  return 100-(100/(1+rs));
}

async function analyze(symbol){
  const url=`https://api.binance.com/api/v3/klines?symbol=${symbol}&interval=1h&limit=500`;
  const r=await fetch(url);
  if(!r.ok) throw new Error(`HTTP ${r.status}`);
  const data=await r.json();
  if(!Array.isArray(data) || data.length===0 || !Array.isArray(data[0])) throw new Error(`Datos invÃ¡lidos (${symbol})`);

  const closes=data.map(k=>parseFloat(k[4]));
  const price=closes.at(-1);
  const ema20=ema(closes,20).at(-1);
  const ema50=ema(closes,50).at(-1);
  const rsi14=rsi(closes,14);
  const max=Math.max(...closes.slice(-24*14));
  const min=Math.min(...closes.slice(-24*14));
  const fib50=min+0.5*(max-min);
  const fib618=min+0.618*(max-min);
  const inZone=price>=fib50&&price<=fib618;
  const trendUp=ema20>ema50;
  let signal="âšª Mirar",color="text-gray-300";
  if(inZone&&trendUp&&rsi14>=50&&rsi14<=65){signal="ðŸŸ¢ Pullback";color="text-green-400";}
  else if(price>max&&trendUp&&rsi14>60){signal="ðŸ”µ Breakout";color="text-cyan-400";}
  const tr=`<tr class='border-b border-gray-800'>
    <td class='py-2 font-semibold'>${symbol}</td>
    <td>$${price.toFixed(2)}</td>
    <td>${rsi14.toFixed(1)}</td>
    <td>${ema20.toFixed(1)} / ${ema50.toFixed(1)}</td>
    <td>${fib50.toFixed(1)}â€“${fib618.toFixed(1)}</td>
    <td class='${color} font-bold'>${signal}</td>
  </tr>`;
  return tr;
}

async function render(){
  const rows=document.getElementById('rows');
  const pair=pairs[idx%pairs.length];
  rows.innerHTML=`<tr><td colspan='6' class='p-4 text-gray-400'>Analizando ${pair}...</td></tr>`;
  try{
    const row=await analyze(pair);
    if(idx%pairs.length===0) rows.innerHTML='';
    rows.innerHTML+=row;
  }catch(e){
    rows.innerHTML=`<tr><td colspan='6' class='p-4 text-red-400'>Error ${e.message}</td></tr>`;
  }
  idx++;
  // Espera 6 s entre tokens y 1 h entre ciclos completos
  if(idx%pairs.length!==0) setTimeout(render,6000);
  else setTimeout(()=>{idx=0;render();},3600000);
}

render();
</script>

<p class="text-xs text-gray-500 mt-4 text-center">
Datos en vivo desde Binance API (1h velas, 500 registros). Calcula RSI14, EMA20/50 y niveles Fibonacci (Ãºltimos 14 dÃ­as).<br>
Actualiza automÃ¡ticamente cada 1 hora. 100 % compatible con GitHub Pages.
</p>
</body>
</html>
